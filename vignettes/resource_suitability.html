<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Ruben Remelgado" />

<meta name="date" content="2018-07-03" />

<title>Predicting Resource Suitability with rsMove</title>

<script>$(document).ready(function(){
    $('[data-toggle="tooltip"]').tooltip();
    $('[data-toggle="popover"]').popover();
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Predicting Resource Suitability with rsMove</h1>
<h4 class="author"><em>Ruben Remelgado</em></h4>
<h4 class="date"><em>2018-07-03</em></h4>



<p></br></p>
<div id="a-remote-sensing-perspective-on-resource-suitability-modelling" class="section level3">
<h3>A Remote Sensing Perspective on Resource Suitability Modelling</h3>
<p align="justify" style="line-height:200%;">
This tutorial is based on the a recently published paper that you can find [here](<a href="https://doi.org/10.5441/001/1.78152p3q">here</a>. This paper introduces a standardized, presence-absence, machine learning approach to predict animal resource suitability and consistently validate its output. This vignette shows users how to replicate this approach using <em>rsMove</em> to map resource suitability related to feeding behaviour.
</p>
</div>
<div id="data" class="section level3">
<h3>Data</h3>
<p align="justify" style="line-height:200%;">
For this exercise we will movement data for one White Stork that describes its movements around its nest. Additionally, we will use a time-series of Normalized Difference Vegetation Index (NDVI) images as predictors.
</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;shortMove&quot;</span>) <span class="co"># movement data</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">ndvi &lt;-<span class="st"> </span><span class="kw">stack</span>(<span class="kw">list.files</span>(<span class="kw">system.file</span>(<span class="st">'extdata'</span>, <span class="st">''</span>, <span class="dt">package=</span><span class="st">&quot;rsMove&quot;</span>), <span class="st">'ndvi.tif'</span>, <span class="dt">full.names=</span><span class="ot">TRUE</span>)) <span class="co"># environmental predictors</span></a></code></pre></div>
<p></br></p>
</div>
<div id="movement-data-pre-processing" class="section level3">
<h3>Movement Data Pre-Processing</h3>
<p align="justify" style="line-height:200%;">
As a first step, we need to remove redundant data points. As animals move through the landscape, they sometimes visit the same locations. Looking at our example data, this issue is frequent. Since the animal is nesting it performed several trips between its nest and the feeding sites.
</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">plot</span>(shortMove)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUAAAD///+l2Z/dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADp0lEQVR4nO3c4ZIZWxSAUfP+L30rbiYY2sdUtX2U9f0hYnK2NafpkuLwpbsdpgdYPUARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgaBlr/9wMomgc6TM9wP0DR3HCHU+O/pzstsoMAbS8P6M7ih4vj7N/NcxNdt8QOuuAZn+myaaBbm+jPtWWQ5ge5sYN+3jDZ/CA3dxCg0wCX50O3nrRHm55j4zkI0HnfHIfvP6y0i1aY4esEdPmqtsJwK8wAqDpsNj3ZKkBfdtAj/ZllLZ2v9YCOlwv5LA80Pt/4AGcBerCLs+rRSVYY4EZLvXk2PkA0Pt/4ANut8Yq/MNCx8fnGB4jG5xsfIBqfb3yAaHy+8QGi8fnGB1g9QBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQNEbAM2OCGjp1R8K0P2GP1oHqJYfXb1a4PMsawKdfz3O0WZuTEA5yop9f5B+/ghbG+j/63bQdc8C7fgolgO6+m6KR46zTwI6dtpBp6/12L4vIEA/Owc6v7h9X0D3xtz7VODtgf5+qc6Oo6zY1Wni7TFfcSK5MNDxouf73B30FNBuj+MdgO6fIH4w0OExoH2fiZYDOlxlB1122jP9NV2HH6A7jbNWTwLt/WK/OND2g788CD/uELuA6bc5PgXo6p2gvzdv/8DpB3ebaa9/+NedHWJnt2zf93j5aUCX1x55JxFQ3He33gFo+4YXtDLQM3+1W+sB3QlQBCgCtN0r3l29vfBrl/t9O//vzt113yJAEaAI0HZjT9DHxV+/5O+aGhTQous+HaAIUARo0QBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBiv4Du9FBdc23tIAAAAAASUVORK5CYII=" /><!-- --></p>
<p align="justify" style="line-height:200%;">
As a consequence, most of the samples will be replicated when sampling from satellite imagery with a much lower temporal resolution using movement data. This pseudo-replication phenomena has two main implications. First, it offers misleading information on the preferences of a species. Since we can not monitor environmental conditions at the same temporal scale at which we can track animals we often miss environmental changes that influence animal decision making. Second, it becomes hard to consistently train and validate any predictive model since samples acquired from the same pixel can be split between training and validation.
</p>
<p align="justify" style="line-height:200%;">
To address this issue, we will use <em>moveReduce()</em>. Considering a shapefile with movement dtaa, this function aggregates temporally consecutive data points that fall within the same pixel and reports on the elapsed time at that location. In addition, the user can choose to derive a raster with the total amount of time elapsed at each pixel. We will take advantage of this functionality.
</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">obs.time &lt;-<span class="st"> </span><span class="kw">strptime</span>(<span class="kw">paste0</span>(shortMove<span class="op">@</span>data<span class="op">$</span>date, <span class="st">' '</span>, shortMove<span class="op">@</span>data<span class="op">$</span>time), <span class="dt">format=</span><span class="st">&quot;%Y/%m/%d %H:%M:%S&quot;</span>) <span class="co"># format observation time</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">reduced.samples &lt;-<span class="st"> </span><span class="kw">moveReduce</span>(shortMove, ndvi, obs.time, <span class="dt">derive.raster=</span><span class="ot">TRUE</span>) <span class="co"># remove redundant data points</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">plot</span>(reduced.samples<span class="op">$</span>total.time) <span class="co"># show total time image</span></a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABDlBMVEUAAAAAADoAAGYAOpAAZrYApgAFqAAMqgASrAAZrwAfsQAmswAttQA1uAA6AAA6ADo6AGY6Ojo6OpA6e3w6kLw6kNs7ugBDvQBMvwBTwQBcxABjxgBmAABmADpmtv9syAB0ygB9zQCFzwCP0QCQOgCQZgCQ2/+Z1ACh1gCs2AC02gC2ZgC2/7a2//+8kDq/3QDI3wDT4QDbkDrb2//b///c4wDm1hLm3Avm5ALnyiLnzxvowTPoxSvpuUPpvDzqtFbqtk3rsWfrsW7rsl3ssXjssn/ts4nttZHuuJruu6Tvvqzvw7XwyL3wzsfw08/x29jx4uDy5+by6+ry7Ozy8vL/tmb/25D//7b//9v////h5w1yAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAI00lEQVR4nO2dZ2PbNhRFWcfdbZoOd6ructPBuINN90j33o0s6///kZLgAy2JAC8AAiJF3vOhlRXwQToCgQcOMFuTTrKhP8DYoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgMiCsuTE/bwO38ir9OVZ/SmPzlG4f4T/hD6f0VjBvvCqsMhO6hdL/cIabpaCLs8aLcW1293hZilotTjVL5fbO1m7i5ilILYgRJFJE2IfZGG1qHckS/uhIPdwFOQY7m/hrnCvEK2C1KRKFDXzEuSRKGpmJchnmNfMSpA9UbSHm5UgtiCER6KomZcgj0RRMzNB8cJpYckqiAUFRa0wLwevi+tZds/NvuGmKUj5eezm1oAfGG6SglaLcuzKj6uXzsO8jYkKOtW5kHOiaGOSglTrKdiC7KwWR+eqCS1tvfTYBeXqh13qYWbZMd6EVbisE8XjSOH86VfBUqW41c+rfuLmRbIKU4eLXEE5ESgF1d1o2V00L5JVmDxc5AqKa6+Xgi6uVzlKcXTevIhXYV7uXeqooiUNGlpQ9yn8MoWr+iCVyVXjcPMivMIdqrErrzoglRH1DhcCEHSfYLraodqjKkF1r1P+t3kRXuE2GwNY72E+FCDofsFUTP28SQWpCUbdIuGp51QAQQ8IhmJqh0q7ix1AC3pQMBQr5Cc8TdhJN33QxsHXHuFCAIIeEmzF8sTD/OhHsYeFLkFzThSzR4ROQdXeVmspok81EEMLelSI9zkmtos9LQwkaPyJ4jOCsVjRmsRHns0fwDD/rGBMFMvxfLtvjt1J2xPFoHBBAEHPCYZiqtVfnh0nHOYPoAU9L9iKVYJmnSi+INguzS/KnzfhbH78o9hLgrlY2Sc3+0CKyaoDQwt6WbDvYtduz1rQK4K1WKkj5S5W6L3L1rMNLehVwVqs7JhTdtJla1wtjjuiDi3oNcF0PEjpWMqJq3TDvNqNRyvoDcFUrDnUkTZRrGsaq6A3BWOxvOkgEs3mm+wnPx6roLeEoSaromW1sF1KPrSgt4WhDnfoqzgvz0Yq6F3BVExluPW1KenOzSOGFvSeYCh2eVa6KKqJ0pwPub4vWIf5IuUwXx8mW3rdzBIbIOhDoTOTTpYoKkHqQEf/axRDAYI+Eaw32ucbM4zoU41KkKjZOR40mjOrHwu2YtUtAilPPZ/InjzaI4ofCZZiS91HpxNkbkFB4YIAgj4TbMeDqk405S6mL78b7VmNTwXLWQ31qVNeQFU5qnIH280+gwv6QjCe1Wiy3Plegpd9LhjzIP2rzjlR/EqwX/5S+ZjxufkvhaEmq/HD+V5QDgR9LViKXdxQHfIhTVYjC7ojmItVdwqsD6wPiizoO8FYbFlPIg9rFIss6BvBVKxMTlRSmDQPQgwt6FvBNtVQghKeF4MMLeh7wTKbVzIO68xqZEE/CF0taNaCfhQOdxe7ayFOBdlPQqegUXfSiQX9LHQJGvcwn1jQL0KXoHEniokF/Sp0Chr1ZDWxoN+Ew52sJhb0u0BBln/9Q7DNxdAO5VvhLv6r4O2SWNCfgnEu5tAl+1a4Q8AqeDZcxegFK90qyP4SjOfmHQZ1Q0iPsiFrmNlIJEgveNV1bt71I7pUuE3IKng2Egn6VzAJcplYGEJ6lLW3IP9Tz4kEGdD/5jQ1NYT0KRywCp6NNIK62IeggFXwbOxf0B52sZjhBhCUvpOOGW7/gvYwzPdJFHcTQ70Qt02Ufl+P22Gfd4txJ4ojEOQyd2+zr0RxDIKC2FeiOAtBbEGIHoniPAT1SBRnIig8HAX1DGcTFa2CUAIq7DpyOXdBeZadXDxxO8GtCNMQVN31madZmmISglS76T5qMHdB6q7nD9ZsQRaagynxb0WYhiC1ssC6GseiL24yEUHxw7mKCa6gLxQUtcL46wdNS1CCVfAmJSjFGmaTEpRiueRJCWILQjisgpecGF/ah8ij2G7ALOAP53J7IXqVFOQVcG6CuIt1gxPFeQtyGObnLchhueR5C2ILQuBEceaCXEaxqTHAb3JYUBDA86B9BpZLnh5+nTRcLnl6eA/z3cslTw/vRHHduVzy9PBvQeuu5ZKnR9CpZ/tyydPDdxQDyyVPD+ZBAAoC+F8f1Llc8vTwFnS1XPLO8wLX9TvyPPGys7pa2dTthvXteO2tfePFwVfQ1WK39aPJq0sWZYVgeVh5XfJYX6y3dr0PaSdee2vPeJHwFdQsl3xLPZq83uvqw2f1w8oVKh/QRx3d7mRb7cRrb+0XLxbBLegd9WjyzTtl64eVV9TLphbyFdzuhSx24rW39osXCz9BuhNYLZ6sH00uXyg7bR5WXpGrD58/nqnHNDjdTXuxG6+9tVe8aHgO83q55Kfk0eTya5ZfSD+sfK1Hu9VC9SknTvdjX+7Ga2/tFS8egXmQfjS5dKqloOad7c9e/tAuX6gdz7K1Y7x4hAlqHk2uDlMf3Xrx5sY7+n91yeunDrtEO55ta7d4EQkT1DyavP7z4sb5xjtbp13Lb+PQqbbj2bZ2ixeRHlONq4aiz5LV70gm0H7gmU+89tbe8eLQU5DKCJvuoP6K+k/1FfIT58RuO157a994cejbgqqhf2uqsdH42w8884nX3tozXhw4mwdQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAjwP2xlSb+x/1GoAAAAAElFTkSuQmCC" /><!-- --></p>
<p align="justify" style="line-height:200%;">
Looking at the output image, we see one pixel standing out with about 400 minutes (i.e. roughly 7 hours). This is the nesting site. Since we are interested in feeding sites alone, we will remove ignore this location. Moreover, we will ignore all the pixels with 0 minutes. These are mainly pixels that were not visited by the animal but also consider those that, while visited, did not record more than one consecutive observation. To do this, we will use the raster package to create a mask, identify the pixels with a value of 1 and use them to build a new shapefile. The output will be our presence samples.
</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">move.mask &lt;-<span class="st"> </span>reduced.samples<span class="op">$</span>total.time <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>reduced.samples<span class="op">$</span>total.time <span class="op">&lt;</span><span class="st"> </span><span class="dv">60</span> <span class="co"># build sample mask</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">usable.pixels &lt;-<span class="st"> </span><span class="kw">which.max</span>(move.mask) <span class="co"># identify relevant pixels</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">presence.samples &lt;-<span class="st"> </span><span class="kw">SpatialPoints</span>(<span class="kw">xyFromCell</span>(move.mask, usable.pixels), <span class="dt">proj4string=</span><span class="kw">crs</span>(shortMove)) <span class="co"># build shapefile from samples (presences)</span></a></code></pre></div>
<p></br></p>
</div>
<div id="identify-absence-samples" class="section level3">
<h3>Identify absence samples</h3>
<p align="justify" style="line-height:200%;">
In the previous steps we translated the <em>shortMove</em> movement data into samples that likely relate to feeding sites. However, to understand how these samples can be distinguished from the rest of the landscape, we need to collect background samples that describe unattractive environmental conditions. While movement data is a strong asset to understand the environmental preferences of an animal it tells us little about its dislikes. Even if a location was not visited by an animal it does not mean it was unsuitable. Factors such as distance and accessibility can condition animal decision making leading it to neglect potentially suitable resources. As a consequence, random background sampling - a commonly used technique - can be misleading as it does not account for the abundance of suitable resources. To address this issue we developed <em>backSample()</em>. This function introduces a new sampling technique that uses presence samples as informants. These are used to collect samples from the remote sensing data and identify pixels where the environmental conditions are statistically different.
</p>
<p align="justify" style="line-height:200%;">
This approach is also sensitive to differences in resource selection. For example, the White Stork is a versatile animal. While they often search for prey in recently managed crop fields they can sometimes be found in grasslands and even wetlands. As a consequence, our presence samples can reflect a diverse set of environmental conditions. To account for this and to better define the environmental boundaries between suitable and unsuitable locations, <em>backSample()</em> requires an index that defines the aggregation of samples with similar environmental attributes. This index is returned by <em>labelSample()</em> which aggregates pixels based on their spatial neighborhood. In this exercise, we will aggregate samples within 60m of each other (i.e. 2 pixels).
</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">sample.id &lt;-<span class="st"> </span><span class="kw">labelSample</span>(presence.samples, ndvi, <span class="dt">agg.radius=</span><span class="dv">60</span>) <span class="co"># aggregate samples in space</span></a></code></pre></div>
<pre><code>## Loading required namespace: igraph</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">sample.id <span class="co"># show indices</span></a></code></pre></div>
<pre><code>## [1] 1 1 1 2 2 2</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">absence.samples &lt;-<span class="st"> </span><span class="kw">backSample</span>(presence.samples, ndvi, sample.id, <span class="dt">sampling.method=</span><span class="st">&quot;pca&quot;</span>) <span class="co"># identify absence samples</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">absence.samples <span class="co"># show samples</span></a></code></pre></div>
<pre><code>## class       : SpatialPointsDataFrame 
## features    : 266 
## extent      : 494700, 495150, 5288220, 5288790  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=utm +zone=32 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 
## variables   : 3
## names       : X2013.07.16_ndvi, X2013.08.01_ndvi, X2013.08.17_ndvi 
## min values  :             2569,             2501,             2556 
## max values  :             8528,             9061,             8786</code></pre>
<p></br></p>
</div>
<div id="derive-and-validate-predict-model" class="section level3">
<h3>Derive and Validate Predict Model</h3>
<p align="justify" style="line-height:200%;">
Similarly to the background sampling approach, the modelling approach follows relies on spatially independent samples to train a predictive model and validate its consistency. The function iterates through each of the presence regions given by <em>sample.id</em> and uses the corresponding samples for validation while the remaining ones are used for training. During this process, a random set of absence samples is selected. Ideally, the function will try to try to equalize the number of presence samples in the training and validation sets. The final validation is an F1 score estimated from the total number of correct and false positives among all iterations. The function <em>predictResources()</em> can be used to perform the training and validation steps.
</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">env.presences &lt;-<span class="st"> </span><span class="kw">extract</span>(ndvi, presence.samples) <span class="co"># extract environmental data for presences</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">env.absences &lt;-<span class="st"> </span><span class="kw">extract</span>(ndvi, absence.samples)  <span class="co"># extract environmental data for absences</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">resourceModel1 &lt;-<span class="st"> </span><span class="kw">predictResources</span>(env.presences, env.absences, sample.id, <span class="dt">env.data=</span>ndvi) <span class="co"># build model</span></a></code></pre></div>
<pre><code>## note: only 2 unique complexity parameters in default grid. Truncating the grid to 2 .
## 
## note: only 2 unique complexity parameters in default grid. Truncating the grid to 2 .
## 
## note: only 2 unique complexity parameters in default grid. Truncating the grid to 2 .</code></pre>
<p align="justify" style="line-height:200%;">
Now let’s have a look at our results. First, let’s make a mask from the output probability map with a threshold of 0.5. Then let’s overlap the presence samples.
</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">plot</span>(resourceModel1<span class="op">$</span>probabilities <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.5</span>) <span class="co"># probability map</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">points</span>(presence.samples) <span class="co"># presences</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p align="justify" style="line-height:200%;">
As shown by the output, the model was able to identify one additional pixel not sampled by <em>presence.samples</em>. But how accurate is the output? To see that we can consult the F1-scores for presences and absences.
</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">kable_styling</span>(<span class="kw">kable</span>(<span class="kw">head</span>(resourceModel1<span class="op">$</span>f1, <span class="dv">2</span>), <span class="dt">format=</span><span class="st">&quot;html&quot;</span>, <span class="dt">align=</span><span class="st">&quot;c&quot;</span>, <span class="dt">full_width=</span><span class="ot">TRUE</span>), <span class="st">&quot;stripped&quot;</span>, <span class="dt">bootstrap_options=</span><span class="st">&quot;responsive&quot;</span>)</a></code></pre></div>
<table class="table table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
presence
</th>
<th style="text-align:center;">
absence
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
0.6666667
</td>
<td style="text-align:center;">
0.9943925
</td>
</tr>
</tbody>
</table>
<p align="justify" style="line-height:200%;">
The accuracies were comparatively higher for absences suggesting an unbalance betwene both classes. This indicates that the chosen environmental predictors might not be suitable to distinguish the selected resources from their surroundings. But what if we had used random background sampling instead of of the proposed approach?
</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">absence.samples &lt;-<span class="st"> </span><span class="kw">backSample</span>(presence.samples, ndvi, <span class="dt">sampling.method=</span><span class="st">&quot;random&quot;</span>) <span class="co"># identify absence samples (random)</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">env.absences &lt;-<span class="st"> </span><span class="kw">extract</span>(ndvi, absence.samples)  <span class="co"># extract environmental data for absences</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3">resourceModel2 &lt;-<span class="st"> </span><span class="kw">predictResources</span>(env.presences, env.absences, sample.id, <span class="dt">env.data=</span>ndvi) <span class="co"># build model</span></a></code></pre></div>
<pre><code>## note: only 2 unique complexity parameters in default grid. Truncating the grid to 2 .
## 
## note: only 2 unique complexity parameters in default grid. Truncating the grid to 2 .
## 
## note: only 2 unique complexity parameters in default grid. Truncating the grid to 2 .</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">plot</span>(resourceModel2<span class="op">$</span>probabilities <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.5</span>) <span class="co"># probability map</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw">points</span>(presence.samples) <span class="co"># presences</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">kable_styling</span>(<span class="kw">kable</span>(<span class="kw">head</span>(resourceModel2<span class="op">$</span>f1, <span class="dv">2</span>), <span class="dt">format=</span><span class="st">&quot;html&quot;</span>, <span class="dt">align=</span><span class="st">&quot;c&quot;</span>, <span class="dt">full_width=</span><span class="ot">TRUE</span>), <span class="st">&quot;stripped&quot;</span>, <span class="dt">bootstrap_options=</span><span class="st">&quot;responsive&quot;</span>)</a></code></pre></div>
<table class="table table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
presence
</th>
<th style="text-align:center;">
absence
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
NaN
</td>
<td style="text-align:center;">
0.9905363
</td>
</tr>
</tbody>
</table>
<p align="justify" style="line-height:200%;">
As shown by the output, only the samples covered by <em>presence.samples</em> received a probability higher than 0.5. Additionally, the F1-score was <em>NaN</em> for presences suggesting that the independent presence regions failed to predict each other.
</p>
<p></br></p>
</div>
<div id="plausibility-test" class="section level3">
<h3>Plausibility Test</h3>
<p align="justify" style="line-height:200%;">
While modelling results might be satisfactory it is ideal to verify if they fit to our expectations, be them data driven or based on empirical observations of the target species. To assist on this, we developed <em>plausibilityTest()</em>. This function allows its user to compare presence-absence maps derived with different modelling approaches against existing categorical information such as land cover maps. Given a stack of masks - where 1 is the usable value - the function will iterate through each band and report on the sum of pixels for each class in a categorical layer. To test this tool, we can use the land cover data provided through <em>rsMove</em>.
</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">landCover &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="kw">system.file</span>(<span class="st">'extdata'</span>, <span class="st">'landCover.tif'</span>, <span class="dt">package=</span><span class="st">&quot;rsMove&quot;</span>))</a></code></pre></div>
<p align="justify" style="line-height:200%;">
Now let’s apply the function using the probability maps derived with <em>pca</em> and <em>random</em> sampling considering only probabilities higher than 0.5. We will also specify the class labels.
</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">class.labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Arable land&quot;</span>, <span class="st">&quot;Land without use&quot;</span>, <span class="st">&quot;Open spaces&quot;</span>, <span class="st">&quot;Wetlands&quot;</span>, <span class="st">&quot;Permanent crops&quot;</span>, <span class="st">&quot;Extraction/Dump sites&quot;</span>, <span class="st">&quot;Industrial areas&quot;</span>, <span class="st">&quot;Green urban areas&quot;</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">probMask &lt;-<span class="st"> </span><span class="kw">stack</span>(resourceModel1<span class="op">$</span>probabilities<span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, resourceModel2<span class="op">$</span>probabilities<span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>) <span class="co"># stack of probabilities (pca and random)</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3">ptest &lt;-<span class="st"> </span><span class="kw">plausibilityTest</span>(probMask, landCover, <span class="dt">class.labels=</span>class.labels)</a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">ptest<span class="op">$</span>relative.plot</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">kable_styling</span>(<span class="kw">kable</span>(<span class="kw">head</span>(ptest<span class="op">$</span>relative.count, <span class="dv">8</span>), <span class="dt">format=</span><span class="st">&quot;html&quot;</span>, <span class="dt">align=</span><span class="st">&quot;c&quot;</span>, <span class="dt">full_width=</span><span class="ot">TRUE</span>), <span class="st">&quot;stripped&quot;</span>, <span class="dt">bootstrap_options=</span><span class="st">&quot;responsive&quot;</span>)</a></code></pre></div>
<table class="table table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
code
</th>
<th style="text-align:center;">
label
</th>
<th style="text-align:center;">
Layer_1
</th>
<th style="text-align:center;">
Layer_2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
Arable land
</td>
<td style="text-align:center;">
0.5714286
</td>
<td style="text-align:center;">
0.5
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
Land without use
</td>
<td style="text-align:center;">
0.0000000
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
Open spaces
</td>
<td style="text-align:center;">
0.4285714
</td>
<td style="text-align:center;">
0.5
</td>
</tr>
<tr>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
Wetlands
</td>
<td style="text-align:center;">
0.0000000
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
Permanent crops
</td>
<td style="text-align:center;">
0.0000000
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
Extraction/Dump sites
</td>
<td style="text-align:center;">
0.0000000
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:center;">
21
</td>
<td style="text-align:center;">
Industrial areas
</td>
<td style="text-align:center;">
0.0000000
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:center;">
23
</td>
<td style="text-align:center;">
Green urban areas
</td>
<td style="text-align:center;">
0.0000000
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
</tbody>
</table>
<p align="justify" style="line-height:200%;">
The output suggests very similar results between both sampling approaches. Most of the pixels with probabilities higher than 0.5 were related to arable land while non-vegetated land cover types as well as <em>Permanent Crops</em> were ignored. Considering that the White Stork is reportedly attracted by agriculture, the output of <em>plausibilityTest()</em> suggests we built a reasonable predictive model.
</p>
<p></br> </br></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
